{"id":"AssurancePlatform-59h","title":"My first issue","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T10:21:42.184897Z","updated_at":"2025-12-24T10:23:10.736974Z","closed_at":"2025-12-24T10:23:10.736974Z","close_reason":"Just testing"}
{"id":"AssurancePlatform-5o1","title":"Code Quality: Replace raw SQL pattern in health check","description":"The health check in app/api/health/route.ts (line 34) uses $queryRaw with a hardcoded query.\n\n**Current code:**\n```typescript\nawait prisma.$queryRaw`SELECT 1`;\n```\n\n**Issue:** While this specific usage is safe (hardcoded query with no user input), using $queryRaw sets a pattern that could be dangerous if copied elsewhere.\n\n**Fix:** Replace with a safer alternative:\n```typescript\nawait prisma.user.count({ take: 1 }); // Prisma ORM method\n```\n\n**Confidence:** 80%","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-24T10:27:30.403578Z","updated_at":"2026-01-02T10:57:51.766249Z","closed_at":"2026-01-02T10:57:51.766249Z","close_reason":"Replaced $queryRaw with prisma.user.count({ take: 1 }) and added unit tests","labels":["code-quality"]}
{"id":"AssurancePlatform-7ce","title":"Security: Fix misleading sanitizeDescription function (XSS risk)","description":"The sanitizeDescription function in lib/sanitize-html.ts (lines 5-8) only removes a single pattern (\u003cp\u003e\u003cbr\u003e\u003c/p\u003e) and doesn't actually sanitize HTML.\n\n**Issue:** The function is named 'sanitize' but provides no actual sanitization, leaving XSS vulnerabilities if used with that expectation.\n\n**Example attack:**\n```javascript\nconst malicious = '\u003cimg src=x onerror=\"alert(document.cookie)\"\u003e\u003cp\u003e\u003cbr\u003e\u003c/p\u003e';\nsanitizeDescription(malicious); \n// Returns: '\u003cimg src=x onerror=\"alert(document.cookie)\"\u003e'\n// XSS still present!\n```\n\n**Fix:** Either use a proper HTML sanitization library (DOMPurify or sanitize-html) or rename to removeEmptyParagraphs() to avoid confusion.\n\n**Confidence:** 95%","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-24T10:27:15.692483Z","updated_at":"2026-01-02T12:07:06.402194Z","closed_at":"2026-01-02T12:07:06.402194Z","close_reason":"Added DOMPurify sanitisation to strip XSS vectors","labels":["security","xss"]}
{"id":"AssurancePlatform-ceo","title":"Security: Address timing attack vulnerability in JWT callback","description":"The JWT callback in lib/auth-options.ts (lines 302-305) checks token expiry and clears expired tokens in a way that creates timing side-channel.\n\n**Issue:** Valid tokens complete the full callback execution path while expired tokens modify the token object then return. This creates measurable timing differences that could be exploited for session enumeration.\n\n**Impact:** An attacker could use timing attacks to determine if a session token has expired without having valid credentials.\n\n**Fix:** Move the expiry validation to a separate middleware or route guard with constant-time checks.\n\n**Confidence:** 85%","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-24T10:27:23.037717Z","updated_at":"2025-12-24T10:27:23.037717Z","labels":["auth","security"]}
{"id":"AssurancePlatform-qxo","title":"Security: Add rate limiting to critical endpoints","description":"Several security-critical endpoints lack rate limiting:\n\n**Affected endpoints:**\n- /api/users/register - Account creation (spam/bot registrations)\n- /api/invites/[token]/accept - Invite acceptance (brute-force token guessing)\n\nNote: Password reset DOES have rate limiting in the service layer.\n\n**Impact:**\n- User enumeration attacks\n- Brute-force invite token guessing\n- Denial of service through resource exhaustion\n- Bot/spam registrations\n\n**Fix:** Implement rate limiting at the API route level using Next.js middleware. Consider IP-based and user-based limits.\n\n**Confidence:** 85%","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-24T10:27:27.006088Z","updated_at":"2025-12-24T10:27:27.006088Z","labels":["rate-limiting","security"]}
{"id":"AssurancePlatform-swc","title":"Security: Validate session keys against database revocation","description":"The isValidSession function in lib/auth-helpers.ts (lines 7-30) only performs client-side validation and doesn't check if the refresh token has been revoked in the database.\n\n**Issue:** This function checks for session key expiry but doesn't validate that the key is actually valid in the database (via the revokedAt field in RefreshToken table).\n\n**Attack Scenario:**\n1. User logs in, gets session with refresh token\n2. Admin revokes all user's tokens (security incident)\n3. User's JWT still contains the key and hasn't expired\n4. isValidSession returns true, allowing continued access\n\n**Fix:** Ensure all security-critical code paths use validateRefreshToken() from the refresh-token-service which does proper database validation, or add a note clarifying this is for quick UI checks only.\n\n**Confidence:** 82%","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-24T10:27:32.943297Z","updated_at":"2025-12-24T10:27:32.943297Z","labels":["auth","security"]}
{"id":"AssurancePlatform-wk0","title":"Security: Enable email verification for invite acceptance","description":"The acceptInvite function in lib/services/case-permission-service.ts (lines 706-710) has email verification commented out, allowing any authenticated user to accept invites meant for specific email addresses.\n\n**Attack Scenario:**\n1. Admin invites alice@company.com with ADMIN permissions\n2. Attacker bob@attacker.com creates account and logs in\n3. Bob intercepts/discovers the invite token\n4. Bob accepts the invite and gains ADMIN access to the case\n\n**Impact:** Authorization bypass allowing privilege escalation.\n\n**Fix:** Enable the email verification check that is already implemented but commented out.\n\n**Confidence:** 90%","status":"open","priority":0,"issue_type":"bug","created_at":"2025-12-24T10:27:11.529298Z","updated_at":"2025-12-24T10:27:11.529298Z","labels":["auth","security"]}
